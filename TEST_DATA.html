<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Data Test - Harmony AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .test-header {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .test-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .test-btn {
            padding: 1rem;
            font-weight: 600;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .results-box {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            margin-bottom: 2rem;
        }

        .success {
            color: #28a745;
            font-weight: 600;
        }

        .error {
            color: #dc3545;
            font-weight: 600;
        }

        .info {
            color: #667eea;
            font-weight: 600;
        }

        .data-count {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .count-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }

        .count-card h3 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .count-card p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
    </style>
</head>

<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üß™ Data Display Test - Harmony AI</h1>
            <p class="text-muted">Click any role below to test the 20-patient data display</p>
        </div>

        <div class="test-buttons">
            <button class="test-btn" onclick="testRole('software_engineer')">üìä Software Engineer</button>
            <button class="test-btn" onclick="testRole('ai_engineer')">ü§ñ AI Engineer</button>
            <button class="test-btn" onclick="testRole('data_scientist')">üìà Data Scientist</button>
            <button class="test-btn" onclick="testRole('mental_health_admin')">üè• Health Admin</button>
            <button class="test-btn" onclick="testRole('emergency_team')">üö® Emergency Team</button>
            <button class="test-btn" onclick="testRole('security_analyst')">üîí Security</button>
            <button class="test-btn" onclick="testRole('financial_team')">üí∞ Financial</button>
            <button class="test-btn" onclick="testRole('system_admin')">‚öôÔ∏è System Admin</button>
        </div>

        <div class="results-box">
            <h3>üìä Data Status</h3>
            <div id="statusLog"></div>

            <div class="data-count" id="dataStats">
                <!-- Will be populated -->
            </div>

            <h4 style="margin-top: 2rem; margin-bottom: 1rem;">üìã Table Output</h4>
            <div id="tableOutput"
                style="max-height: 600px; overflow-y: auto; border: 2px solid #ddd; border-radius: 10px; padding: 1rem; background: #f9f9f9;">
                <p class="text-muted">Click a role above to display data...</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/dummy-data.js"></script>
    <script src="assets/js/designation-data-tables.js"></script>
    <script>
        // Status logging function
        function log(message, type = 'info') {
            const statusLog = document.getElementById('statusLog');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'info';
            const emoji = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è';
            const line = document.createElement('div');
            line.innerHTML = `<span class="${className}">${emoji} [${timestamp}] ${message}</span>`;
            statusLog.appendChild(line);
            console.log(`[${type.toUpperCase()}]`, message);
        }

        // Initialize data status
        function initStatus() {
            log('Testing Harmony AI Data System...', 'info');

            // Check DummyData
            if (window.DummyData) {
                log('‚ú® DummyData loaded successfully', 'success');

                // Count all data
                const users = window.DummyData.getUsers();
                const logs = window.DummyData.getLogs();
                const sessions = window.DummyData.getSessions();
                const feedback = window.DummyData.getFeedback();
                const progress = window.DummyData.getProgress();
                const recommendations = window.DummyData.getRecommendations();
                const aiAnalysis = window.DummyData.getAIAnalysis();
                const crisis = window.DummyData.getCrisisAlerts();
                const emergency = window.DummyData.getEmergencyContacts();
                const counsellors = window.DummyData.getCounsellors();

                log(`Found ${users.length} patients (P001-P020)`, 'success');
                log(`Found ${counsellors.length} counsellors`, 'success');

                // Display stats
                displayStats(users, logs, sessions, feedback, progress, recommendations, aiAnalysis, crisis, emergency, counsellors);
            } else {
                log('DummyData not loaded!', 'error');
            }

            // Check DesignationDataTables
            if (window.DesignationDataTables) {
                log('‚ú® DesignationDataTables loaded successfully', 'success');
            } else {
                log('DesignationDataTables not loaded!', 'error');
            }
        }

        // Display data statistics
        function displayStats(users, logs, sessions, feedback, progress, recommendations, aiAnalysis, crisis, emergency, counsellors) {
            const statsHTML = `
                <div class="count-card">
                    <h3>${users.length}</h3>
                    <p>Patients</p>
                </div>
                <div class="count-card">
                    <h3>${counsellors.length}</h3>
                    <p>Counsellors</p>
                </div>
                <div class="count-card">
                    <h3>${logs.length}</h3>
                    <p>Mood Logs</p>
                </div>
                <div class="count-card">
                    <h3>${sessions.length}</h3>
                    <p>Sessions</p>
                </div>
                <div class="count-card">
                    <h3>${feedback.length}</h3>
                    <p>Feedback</p>
                </div>
                <div class="count-card">
                    <h3>${progress.length}</h3>
                    <p>Progress</p>
                </div>
                <div class="count-card">
                    <h3>${recommendations.length}</h3>
                    <p>Recommendations</p>
                </div>
                <div class="count-card">
                    <h3>${aiAnalysis.length}</h3>
                    <p>AI Analysis</p>
                </div>
                <div class="count-card">
                    <h3>${crisis.length}</h3>
                    <p>Crisis Alerts</p>
                </div>
                <div class="count-card">
                    <h3>${emergency.length}</h3>
                    <p>Emergency Contacts</p>
                </div>
                <div class="count-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h3>${logs.length + sessions.length + feedback.length + progress.length + recommendations.length + aiAnalysis.length + crisis.length + emergency.length}</h3>
                    <p>Total Records</p>
                </div>
            `;
            document.getElementById('dataStats').innerHTML = statsHTML;
        }

        // Test role function
        async function testRole(role) {
            const tableOutput = document.getElementById('tableOutput');
            tableOutput.innerHTML = '<p class="text-muted">Loading...</p>';

            log(`Testing role: ${role.replace(/_/g, ' ').toUpperCase()}`, 'info');

            try {
                if (!window.DesignationDataTables) {
                    throw new Error('DesignationDataTables not loaded');
                }

                let tableHTML = '';
                const roleMap = {
                    'software_engineer': 'getSoftwareEngineerTable',
                    'ai_engineer': 'getAIEngineerTable',
                    'data_scientist': 'getDataScientistTable',
                    'mental_health_admin': 'getMentalHealthAdminTable',
                    'emergency_team': 'getEmergencyTeamTable',
                    'security_analyst': 'getSecurityAnalystTable',
                    'financial_team': 'getFinancialTeamTable',
                    'system_admin': 'getSystemAdminTable'
                };

                const method = roleMap[role];
                if (!window.DesignationDataTables[method]) {
                    throw new Error(`Method ${method} not found`);
                }

                tableHTML = await window.DesignationDataTables[method]();

                if (!tableHTML) {
                    throw new Error('No table HTML returned');
                }

                tableOutput.innerHTML = tableHTML;
                log(`‚ú® Table displayed for ${role}!`, 'success');

            } catch (error) {
                log(`Error: ${error.message}`, 'error');
                tableOutput.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p><pre>${error.stack}</pre>`;
            }
        }

        // Initialize on load
        window.addEventListener('load', initStatus);
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>