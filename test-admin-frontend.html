<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Frontend Test - Harmony AI</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #2A9D8F 0%, #1F7A6E 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
        }

        .card-header {
            background: linear-gradient(135deg, #2A9D8F 0%, #1F7A6E 100%);
            color: white;
            border-radius: 12px 12px 0 0;
            padding: 20px;
        }

        .card-body {
            padding: 20px;
        }

        .test-result {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 4px solid #ddd;
        }

        .test-result.success {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }

        .test-result.error {
            background: #ffebee;
            border-left-color: #f44336;
        }

        .test-result.loading {
            background: #e3f2fd;
            border-left-color: #2196f3;
        }

        .btn-test {
            background: #2A9D8F;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
        }

        .btn-test:hover {
            background: #1F7A6E;
        }

        .data-preview {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.85rem;
        }

        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #2A9D8F;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2 style="margin: 0;">üß™ Admin Frontend Test</h2>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">Test API connectivity and data loading</p>
            </div>
            <div class="card-body">
                <div id="results"></div>
                <button class="btn-test" onclick="runTests()">üöÄ Run All Tests</button>
                <button class="btn-test" onclick="openAdmin()" style="background: #4caf50; margin-left: 10px;">‚úÖ Open
                    Admin Panel</button>
            </div>
        </div>
    </div>

    <script src="assets/js/api-service.js"></script>
    <script>
        async function runTests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            // Test 1: API Service Loaded
            addResult('API Service Loaded', 'loading');
            if (typeof ApiService !== 'undefined') {
                updateResult('API Service Loaded', 'success', 'ApiService is available');
            } else {
                updateResult('API Service Loaded', 'error', 'ApiService not found');
                return;
            }

            // Test 2: Get Users
            addResult('Fetching Users', 'loading');
            try {
                const users = await ApiService.getUsers();
                if (Array.isArray(users) && users.length > 0) {
                    updateResult('Fetching Users', 'success', `‚úÖ ${users.length} users loaded`);
                    showDataPreview('Users Data', users.slice(0, 3));
                } else {
                    updateResult('Fetching Users', 'error', 'No users returned');
                }
            } catch (error) {
                updateResult('Fetching Users', 'error', error.message);
            }

            // Test 3: Get Daily Logs
            addResult('Fetching Daily Logs', 'loading');
            try {
                const logs = await ApiService.getDailyLogs();
                if (Array.isArray(logs) && logs.length > 0) {
                    updateResult('Fetching Daily Logs', 'success', `‚úÖ ${logs.length} logs loaded`);
                } else {
                    updateResult('Fetching Daily Logs', 'error', 'No logs returned');
                }
            } catch (error) {
                updateResult('Fetching Daily Logs', 'error', error.message);
            }

            // Test 4: Get Counsellors
            addResult('Fetching Counsellors', 'loading');
            try {
                const counsellors = await ApiService.getCounsellors();
                if (Array.isArray(counsellors) && counsellors.length > 0) {
                    updateResult('Fetching Counsellors', 'success', `‚úÖ ${counsellors.length} counsellors loaded`);
                } else {
                    updateResult('Fetching Counsellors', 'error', 'No counsellors returned');
                }
            } catch (error) {
                updateResult('Fetching Counsellors', 'error', error.message);
            }

            // Test 5: Get Sessions
            addResult('Fetching Sessions', 'loading');
            try {
                const sessions = await ApiService.getSessions();
                if (Array.isArray(sessions) && sessions.length > 0) {
                    updateResult('Fetching Sessions', 'success', `‚úÖ ${sessions.length} sessions loaded`);
                } else {
                    updateResult('Fetching Sessions', 'error', 'No sessions returned');
                }
            } catch (error) {
                updateResult('Fetching Sessions', 'error', error.message);
            }

            // Test 6: Get Statistics
            addResult('Fetching Statistics', 'loading');
            try {
                const stats = await ApiService.getStatistics();
                if (stats && stats.totalUsers) {
                    updateResult('Fetching Statistics', 'success', `‚úÖ Statistics loaded (${stats.totalUsers} users)`);
                } else {
                    updateResult('Fetching Statistics', 'error', 'No statistics returned');
                }
            } catch (error) {
                updateResult('Fetching Statistics', 'error', error.message);
            }

            // Summary
            addResult('All Tests Complete', 'success', '‚úÖ Frontend is working correctly!');
        }

        function addResult(title, status, message = '') {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.id = `result-${title.replace(/\s+/g, '-')}`;
            resultDiv.className = `test-result ${status}`;

            const spinner = status === 'loading' ? '<span class="spinner"></span> ' : '';
            const icon = status === 'success' ? '‚úÖ' : status === 'error' ? '‚ùå' : '‚è≥';

            resultDiv.innerHTML = `
                <strong>${icon} ${title}</strong>
                ${message ? `<br><small>${message}</small>` : ''}
            `;
            resultsDiv.appendChild(resultDiv);
        }

        function updateResult(title, status, message) {
            const resultId = `result-${title.replace(/\s+/g, '-')}`;
            const resultDiv = document.getElementById(resultId);
            if (resultDiv) {
                const icon = status === 'success' ? '‚úÖ' : status === 'error' ? '‚ùå' : '‚è≥';
                resultDiv.className = `test-result ${status}`;
                resultDiv.innerHTML = `
                    <strong>${icon} ${title}</strong>
                    <br><small>${message}</small>
                `;
            }
        }

        function showDataPreview(title, data) {
            const resultsDiv = document.getElementById('results');
            const previewDiv = document.createElement('div');
            previewDiv.className = 'data-preview';
            previewDiv.innerHTML = `<strong>${title}:</strong><br>${JSON.stringify(data, null, 2)}`;
            resultsDiv.appendChild(previewDiv);
        }

        function openAdmin() {
            window.location.href = 'admin-full.html';
        }

        // Auto-run tests on load
        window.addEventListener('DOMContentLoaded', () => {
            console.log('üß™ Frontend test page loaded');
            runTests();
        });
    </script>
</body>

</html>